---
title: "finalproj"
output: html_document
date: "2023-12-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Needed packages 

```{r}
library(tidyverse)
library(skimr)
library(visdat)
```

# Introduction- Step 1: Formulate your research question 

## Are certain industries more likely to lack race and/or gender representation than others?


  My primary question is: are certain industries more likely to lack the representation relating to race and/or gender? Answering this question could be accompanied by more questions relating to the “why” of it. Results from the data could guide additional investigation of pathways/resources to certain industries when considering race and/or gender backgrounds. Further concerns of representation could be questioned and reviewed in different settings due to these results. Overall these findings could contribute to any possible needed awareness.
  Discrimination and systematic oppression are continued social discussions and fights for both women and ethnic minority communities. Discussing occupations and industries contribute to a conversation about existing passive discrimination and needed representation in the workforce. Relaying the question and data to the general public could bring awareness to the importance and benefits of genuine representation. It is essential to have a comprehensive idea of this to increase diversity and equal opportunity. A lack of representation could also call for better cultural sensitivity training and accommodations in the workplace. They may also lead to advocacy for implementations/training needed to diversify occupations/industries. 

# Methods- Step 2: Get the Data/read in your data

Instruction from tidytuesday are to: Read in with tidytuesdayR package, Install from CRAN via:install.packages("tidytuesdayR"), and loading the readme and all the datasets for the week of interest. This code is commented out do to issues with formulating HTML, please un-comment if needed.

```{r}
#tuesdata <- tidytuesdayR::tt_load('2021-02-23')
#tuesdata <- tidytuesdayR::tt_load(2021, week = 9)

#employed <- tuesdata$employed
```

The data can also be read in the data manually.

```{r}
employed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-23/employed.csv')

earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-23/earn.csv') 
``` 

  The data set is pulled from Tidy Tuesday. The data was generated by the Bureau of Census for the Bureau of Labor Statistics, where data can be found. Specifically data was collected from "table cpsaat17" over the the time period (2015-2020) provided bty the Bureau of Labor Statistics. This was collected by using The Current Population Survey (CPS) and Current Employment Statistics (CES). These surveys reflect details of  employment, unemployment, hours of work, earnings, people who are not in the labor force, and demographics. It should also be noted that they are monthly surveys. The Current Population Survey (CPS) is not limited to gathering information regarding employment, but will be used for employment, employment related status, and demographics in this project. The Bureau of Labor Statistics claim the data is processed and stored on secure servers, and microdata on  public-use files. The Bureau of Census collects data, does field editing/ coding, checks consistency, quality control, and transmits data to the Bureau of Labor Statistics. Following this data is again edited and made available to the public. 
  The Bureau of Labor Statistics provides data for “users of BLS data” for a variety of purposes. One of the earliest uses of the data was investigating effects of tariff legislations and has continued to be a source for employment related research, laws, understanding, etc. Considering the multiple uses of the data set, it would seem that the mutability or immutability of the data is important. The data is collected using a survey in households across the country, which is a large data set.  Change or stagnation in the data could provide perception of changes or needed changes in this population. I would believe that the idea of mutability and immutability of the data have been created and maintained through different events and simply time within the population. 
  Using functions in R Studio, I plan on selecting specific variables such as industries, races, year, and gender. The data will be downloaded from Tidy Tuesday which incorporates employed persons by industry, sex, race, year and occupation and weekly median earnings and number of persons employed by race/gender/age group over time. The variables available using this data set could be consistent with the idea of power relations, by only including employment and employed related data. This could potentially set the data up to reflect under representation in certain industries, occupations, employment, and/or weekly median earnings. Or this data could be set up to reflect over representation. 
  
# Results-Step 3: checking package

```{r}
skim(employed)
```

The data includes major and minor occupations in each industry. Industry has a .96 completion rate and a 1.0 completion rate for, major_occupation, minor_occupation, race_gender, and year. Industry_total and employ_n both have a completion rate of .919. For the purpose of the research question we only looked at industry and race_gender.  

```{r}
count(employed, industry) 
count(employed, race_gender)
```
Industries in this data include: Agriculture and related, Construction, Durable goods, Education and health services, 		Financial activities, Information, Leisure and hospitality, Manufacturing, Mining, quarrying, and\r\noil and gas extraction,	Mining, quarrying, and oil and gas extraction, Nondurable goods, Other services, Other services, except private households,	Private households, Professional and business services, Public administration, Retail trade, Transportation and utilities,		Wholesale and retail trade, Wholesale trade. The data also includes "Asian", "Black or African Amerian", "Men", "White", and "NA." Race_gender consist of: Asian, Black or African American, White, Men, TOTAL, and Women. 

```{r}
summary(employed$industry)
summary(employed$race_gender)
summary(employed$year)
``` 

#Missing values

```{r}
vis_miss(employed)
```

97.1% of the values in the "employed" data is present. From here we will continue to work with "employed" data. The 'cluster= TRUE uses hierachical cluster to order the rows. 

```{r}
vis_miss(employed, cluster = TRUE) +
  coord_flip()
``` 

# Results-Step 4: Look at the top and the bottom of your data 

```{r}
#employed |> head() |> View()

#employed |> tail() |> View()
```

The head of the data includes information of Agriculture and related, from 2020, and race_gender being "TOTAL." The tail of the data is Public administration, from 2015, and race_gender being "Asian." Head and tail view are commented out due to HTML format, please uncomment. 

# Results-Step 5: check your Ns

```{r}
nrow(employed)

min(employed$year, na.rm = TRUE)
max(employed$year, na.rm = TRUE)
```

The number of rows are 8184 and the data range is from 2015 to 2020. 

# Results-Step 6: Make a plot 

```{r}
employed |>
  mutate(year) |>
  ggplot(aes(year))+
  geom_bar()
```

```{r}
table(employed$year)
```

```{r}
table(employed$year, employed$race_gender)
```
  The first code of this section (6) provdies a visual and the second code provides numeric count from every year. It seems that the count is the same every year, 1364. The third code provides numeric values of 'race_gender' variables each year, appears to have the same count every year.
  From here we will filter out 'Women', 'NA', 'White', 'Asian', and 'Black or African American' from the industry column in all codes, but not from all race_gender. Depending on if visuals are focusing on gender or race, there will be some filtering. 

#Gender  
```{r}
#| fig.width: 12
#| fig.height: 8
employed |>
    filter(race_gender %in% c("Women", "Men")) |>
    filter(!(industry %in% c("Women", "NA", "White"))) |>
    ggplot(aes(x = year, y = employ_n, fill = race_gender)) +
    geom_bar(stat = "identity") +
    facet_wrap(vars(industry), scales = 'free_y')
```

This graph displays women in blue and men in pink in different bar graphs for each industry. These graphs suggest that "Private household" and "Education and health services" to be obviously more dominated by female than male. In industries such as "Agriculture and related", "Construction", "Durable goods", "Manufacturing", "Mining, quarrying, and oil and gas extraction", "Mining, quarrying, and oil and gas extraction", "Non durable goods", "Transportation and utilities" and "Wholesale trade" seem to be more dominated by males than females. The X-axis is year and Y-axis is employment count. In this code "Women", "NA", and "White" are excluded from industry.  

#Race
```{r}
employed |>
  filter(race_gender %in% c("Asian", "Black or African American", 'White')) |>
  filter(!(industry %in% c("Women", "NA", "White", 'Asian', "Black or African American"))) |>
  ggplot(aes(x = year, y = employ_n, fill = race_gender)) +
  geom_bar(stat = "identity") +
  facet_wrap(vars(industry), scales = 'free_y')
```

This graph provides visual of the three different races in each industries, and the display implies that white individuals dominate all industries. Each bar graph is an inudustry with the X-axis being year and Y-axis being employment count. In this code "Women", "NA", "White", "Asian", and "Black or African American" are exluded from industry column.  
 
# Results-Step 7: switching to plots and lines 

#Gender 

```{r}
employed %>%
  filter(race_gender %in% c('Women', 'Men')) %>%
  filter(!(industry %in% c("Women", "NA", "White"))) |>
  ggplot(aes(x = year, y = employ_n, color = race_gender, group = interaction(industry, race_gender))) +
  geom_line() +
  geom_point(position = position_dodge(width = 0.2), alpha = 0.5) +
  facet_wrap(~industry, scales = 'free_y') +
  labs(title = "Female and Male Employment in Different Industries Over Time",
       x = "Year",
       y = "Employment",
       color = "Gender") +
  theme_minimal()
```

#Race
```{r}
employed %>%
  filter(race_gender %in% c('Asian', 'Black or African American', 'White')) %>%
  filter(!(industry %in% c('Women', 'NA', 'White', 'Asian', 'Black or African American'))) |>
  ggplot(aes(x = year, y = employ_n, color = race_gender, group = interaction(industry, race_gender))) +
  geom_line() +
  geom_point(position = position_dodge(width = 0.2), alpha = 0.5) +
  facet_wrap(~industry, scales = 'free_y') +
  labs(title = "Female and Male Employment in Different Industries Over Time",
       x = "Year",
       y = "Employment",
       color = "Gender") +
  theme_minimal()
```

Both plot graphs show similar patterns to the previous bar graphs. In the first code, which looks at gender, excludes "Women", "NA", "White" from industry. In the second code, which presents race, excludes 'Women', 'NA', 'White', 'Asian', and 'Black or African American' from industry. 

# Resutls-Step 8: Fitted Regression Curve 

#Gender excluding "Education and health services" 
```{r}
ggplot(employed %>% 
         filter(race_gender %in% c('Men', 'Women') & !(industry %in% c('White', 'Women','NA', 'Education and health services'))), 
       aes(x = year, y = employ_n, color = race_gender)) +
  geom_point() +
  geom_smooth(aes(group = industry), method = "lm", se = FALSE, linetype = "dashed") +
  labs(title = "Fitted Regression Curve by Race Gender and Industry (Excluding 'White' and 'Women')", x = "Year", y = "Employment") +
  theme_minimal() +
  facet_wrap(~industry)
```

#Gender only in "Education and health services" 
```{r}
ggplot(employed %>% 
         filter(race_gender %in% c('Men', 'Women') & industry == 'Education and health services'), 
       aes(x = year, y = employ_n, color = race_gender)) +
  geom_point() +
  geom_smooth(aes(group = industry), method = "lm", se = FALSE, linetype = "dashed") +
  labs(title = "Fitted Regression Curve by Race Gender and Industry (Including Only 'Education and health services')", x = "Year", y = "Employment") +
  theme_minimal() +
  facet_wrap(~industry)

```

#Race
```{r}
ggplot(employed %>% 
           filter(race_gender %in% c('Asian', 'Black or African American','White') &
                    !(industry %in% c('White', 'Women', 'NA', 'Asian', 'Black or African American'))), 
         aes(x = year, y = employ_n, color = race_gender)) +
  geom_point() +
  geom_smooth(aes(group = industry), method = "lm", se = FALSE, linetype = "dashed") +
  labs(title = "Fitted Regression Curve by Race Gender and Industry (Excluding 'White' and 'Women')", x = "Year", y = "Employment") +
  theme_minimal() +
  facet_wrap(~industry)
```

The above codes provide visuals for fitted regression curve or men and women in each industry. "Education and health services" are excluded, as it has been mentioned that women seem to have higher numbers in that industry. The second code is just looking at gender in "Education and health services." In the first code 'White', 'Women','NA', 'Education and health services' are excluded from industry. In the third code, displaying race, excludes 'White', 'Women', 'NA', 'Asian', and 'Black or African American' from industry column. All graphs have an X-axis of year and Y-axis industry. 

# Results-Step 9: Scatterplot 

Below is the code for a scatter plot of 'Men' in pink and 'Women' in blue. The X-axis is year, Y-axis displays industry, and plots are gender(men and women). Unlike the previous graphs, there appears to be more women plotted than men. 'White', 'Women', 'NA', 'Asian', and 'Black or African American' are excluded from industry.  
#Gender
```{r}
ggplot(employed, aes(x = year, y = as.factor(industry), color = race_gender)) +
  geom_point(data = subset(employed, race_gender %in% c('Men', 'Women') & !industry %in% c('Asian', 'White', 'Women')),
             position = position_jitter(width = 0.3), size = 3, alpha = 0.7) +
  labs(title = "Scatter Plot of Count by Year, Industry, and Race/Gender",
       x = "Year",
       y = "Industry Count",
       color = "Race/Gender") +
  theme_minimal() 
```

Below here is a scatter plot of race: Asian (pink), Black or African American (green), and White (blue). Similar to previous graph, the X-axis is year and Y-axis are the different industries. It appears to be evenly scattered every year between the three races. 'Asian', 'White', and 'Women'are exluded from industry. 

#Race
```{r}
ggplot(employed, aes(x = year, y = as.factor(industry), color = race_gender)) +
  geom_point(data = subset(employed, race_gender %in% c('White', 'Asian', 'Black or African American')
                           & !industry %in% c('Asian', 'White', 'Women')),
             position = position_jitter(width = 0.3), size = 3, alpha = 0.7) +
  labs(title = "Scatter Plot of Count by Year, Industry, and Race/Gender",
       x = "Year",
       y = "Industry Count",
       color = "Race/Gender") +
  theme_minimal() 
```

# Results-Step 10: Try the easy solution first

The code below reviews the Pr(working in education and health services/women) vs Pr(education and health services/men) and Pr(working in education and health services/ Asian) vs Pr(education and health services/Black or African American). Oddly, it suggests that every race and gender all have similar percentage in this industry. This does not reflect the graphs above. 

```{r}
employed %>%
  filter(industry == 'Education and health services') |> 
  count(race_gender) |>  
  mutate(share = n / sum(n)) |>  
  arrange(desc(share)) |> 
  mutate(share = scales::percent(share, accuracy = 1)) 
```

# Conslusion 

This exploratory data analysis suggests that White and Men are more represented than other races and genders. This data is not fit for purpose due to it not including all genders and all races. Future research needs to include all genders and races.

# References 

tidytuesday.(2021, February 23) retrieved from https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-02-23/readme.md

Labor Force Statistics from the Current Population Survey. retrieved from: https://www.bls.gov/cps/tables.htm#charemp_m

